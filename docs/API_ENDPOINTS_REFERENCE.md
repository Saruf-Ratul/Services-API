# REST API Endpoints Reference

## Complete API Endpoint Listing

Your REST API now has **47 total endpoints** across **13 controllers** covering all original SOAP functionality!

---

## ğŸ” Authentication Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/api/auth/login` | User authentication | No |
| POST | `/api/auth/logout` | User logout | Yes |
| GET | `/api/auth/me` | Get current user info | Yes |

---

## ğŸ‘¥ Customers Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/customers` | List all customers | Yes |
| GET | `/api/customers/{id}` | Get customer by ID | Yes |
| POST | `/api/customers` | Create new customer | Admin |
| PUT | `/api/customers/{id}` | Update customer | User/Admin |
| DELETE | `/api/customers/{id}` | Delete customer | Admin |

**Query Parameters**:
- `date` - Filter by date
- `companyId` - Filter by company

---

## ğŸ“… Appointments Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/appointments` | List appointments | Yes |
| GET | `/api/appointments/with-forms` | List with forms | Yes |
| GET | `/api/appointments/{id}` | Get appointment | Yes |
| POST | `/api/appointments` | Create appointment | Yes |
| PUT | `/api/appointments/{id}` | Update appointment | Yes |
| POST | `/api/appointments/csl-image` | Save CSL image | Yes |
| GET | `/api/appointments/csl-images` | Get CSL images | Yes |
| POST | `/api/appointments/assign-form` | Assign form | Yes |

**Query Parameters**:
- `appointmentDate` - Date filter
- `companyId` - Company filter
- `userId` - User filter
- `appointmentTypeStatus` - Status filter

---

## ğŸ’° Invoices Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/invoices` | List invoices | Yes |
| GET | `/api/invoices/{id}` | Get invoice | Yes |
| POST | `/api/invoices` | Create invoice | Yes |
| POST | `/api/invoices/{id}/payments` | Add payment | Yes |
| GET | `/api/invoices/autogenerated-number` | Get auto invoice number | Yes |
| POST | `/api/invoices/{id}/convert-to-invoice` | Convert estimate | Yes |
| PUT | `/api/invoices/{id}/edit` | Edit invoice | Yes |

**Query Parameters**:
- `date` - Date filter
- `companyId` - Company filter

---

## ğŸ“Š Status Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/status/appointments` | Appointment statuses | Yes |
| GET | `/api/status/tickets` | Ticket statuses | Yes |

**Query Parameters**:
- `companyId` - Company filter

---

## ğŸ’µ Tax Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/tax` | Get all taxes | Yes |

**Query Parameters**:
- `companyId` - Company filter

---

## ğŸ“¦ Items Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/items` | Get all items | Yes |

**Query Parameters**:
- `companyId` - Company filter

---

## ğŸ“‹ Forms Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/forms` | List form templates | Yes |
| POST | `/api/forms` | Create form template | Yes |
| PUT | `/api/forms/{id}` | Update form template | Yes |
| DELETE | `/api/forms/{id}` | Delete form template | Yes |

**Query Parameters**:
- `companyId` - Company filter (for all)

---

## ğŸ·ï¸ Tags Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/tags` | List all tags | Yes |
| GET | `/api/tags/{id}` | Get tag by ID | Yes |
| POST | `/api/tags` | Create tag | Yes |
| PUT | `/api/tags/{id}` | Update tag | Yes |
| DELETE | `/api/tags/{id}` | Delete tag | Yes |

**Query Parameters**:
- `companyId` - Company filter

---

## ğŸ“ Notes Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/notes` | List all notes | Yes |
| POST | `/api/notes` | Create note | Yes |
| PUT | `/api/notes/{id}` | Update note | Yes |
| DELETE | `/api/notes/{id}` | Delete note | Yes |

**Query Parameters**:
- `companyId` - Company filter

---

## ğŸ“§ Email Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/api/email/send` | Send HTML email | Yes |
| GET | `/api/email/autofill` | Get autofill values | Yes |

**Query Parameters**:
- `companyId` - Company filter (autofill)

---

## ğŸ’³ Payment Links Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/api/paymentlink/xpay` | Get XPay link | Yes |
| POST | `/api/paymentlink/generate` | Generate XPay link | Yes |

**Query Parameters** (GET):
- `rmCompanyID`, `customerID`, `invoiceNo`, `customerName`, `email`, `amount`

---

## ğŸ“± SMS Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/api/sms/send` | Send SMS | Yes |

---

## ğŸ’š Health Check Endpoints

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/health` | Health check | No |
| GET | `/health-ui` | Health UI dashboard | No |

---

## ğŸ”„ SOAP to REST Mapping

### Original SOAP Methods

| SOAP Method | REST Endpoint | Status |
|-------------|---------------|--------|
| `VerifyUser` | `POST /api/auth/login` | âœ… Migrated |
| `GetCustomerList` | `GET /api/customers` | âœ… Migrated |
| `AddCustomer` | `POST /api/customers` | âœ… Migrated |
| `GetAppointmentList` | `GET /api/appointments` | âœ… Migrated |
| `UpdateAppointment` | `PUT /api/appointments/{id}` | âœ… Migrated |
| `GetAppointmentListWithForms` | `GET /api/appointments/with-forms` | âœ… Migrated |
| `SaveImageForCSL` | `POST /api/appointments/csl-image` | âœ… Migrated |
| `GetImageForCSL` | `GET /api/appointments/csl-images` | âœ… Migrated |
| `AssignForm` | `POST /api/appointments/assign-form` | âœ… Migrated |
| `GetInvoiceList` | `GET /api/invoices` | âœ… Migrated |
| `CreateInvoice` | `POST /api/invoices` | âœ… Migrated |
| `AddPayment` | `POST /api/invoices/{id}/payments` | âœ… Migrated |
| `GetAutoGeneratedInvoice` | `GET /api/invoices/autogenerated-number` | âœ… Migrated |
| `ConvertEstimateToInvoice` | `POST /api/invoices/{id}/convert-to-invoice` | âœ… Migrated |
| `EditInvoice` | `PUT /api/invoices/{id}/edit` | âœ… Migrated |
| `GetStatusList` | `GET /api/status/appointments` | âœ… Migrated |
| `GetTicketStatusList` | `GET /api/status/tickets` | âœ… Migrated |
| `GetTaxList` | `GET /api/tax` | âœ… Migrated |
| `GetAllItemList` | `GET /api/items` | âœ… Migrated |
| `GetAllFormTemplates` | `GET /api/forms` | âœ… Migrated |
| `SaveFormTemplate` | `POST /api/forms` | âœ… Migrated |
| `UpdateFormTemplate` | `PUT /api/forms/{id}` | âœ… Migrated |
| `DeleteFormTemplate` | `DELETE /api/forms/{id}` | âœ… Migrated |
| `GetAllTags` | `GET /api/tags` | âœ… Migrated |
| `GetTagById` | `GET /api/tags/{id}` | âœ… Migrated |
| `SaveTag` | `POST /api/tags` | âœ… Migrated |
| `UpdateTag` | `PUT /api/tags/{id}` | âœ… Migrated |
| `DeleteTag` | `DELETE /api/tags/{id}` | âœ… Migrated |
| `GetAllNote` | `GET /api/notes` | âœ… Migrated |
| `SaveNote` | `POST /api/notes` | âœ… Migrated |
| `UpdateNote` | `PUT /api/notes/{id}` | âœ… Migrated |
| `DeleteNote` | `DELETE /api/notes/{id}` | âœ… Migrated |
| `SendHtmlFormattedEmail` | `POST /api/email/send` | âœ… Migrated |
| `GetAutoFillValuesForEmail` | `GET /api/email/autofill` | âœ… Migrated |
| `GetXPayLink` | `GET /api/paymentlink/xpay` | âœ… Migrated |
| `GenerateXPayLink` | `POST /api/paymentlink/generate` | âœ… Migrated |
| `SendCustomerSMS` | `POST /api/sms/send` | âœ… Migrated |

**Total**: 37 SOAP methods migrated to REST

---

## ğŸ“– API Documentation

### Swagger UI

Access the interactive API documentation at:
- **HTTPS**: https://localhost:7148/swagger
- **HTTP**: http://localhost:5148/swagger

### Features
- âœ… Try it out functionality
- âœ… Authentication support
- âœ… Request examples
- âœ… Response schemas
- âœ… Error definitions

---

## ğŸ”‘ Authentication

### JWT Bearer Token

```http
Authorization: Bearer your-jwt-token-here
```

### OAuth2/OIDC

Click "Authorize" in Swagger and use OAuth2 flow

### Basic Auth

```http
Authorization: Basic base64(username:password)
```

---

## ğŸ“Š Response Formats

### Success Response (200 OK)
```json
{
  "id": "123",
  "name": "Example",
  "status": "success"
}
```

### Created Response (201 Created)
```json
{
  "id": "new-id",
  "message": "Resource created"
}
```

### Error Response (400 Bad Request)
```json
{
  "error": {
    "message": "Invalid input",
    "details": "...",
    "traceId": "..."
  }
}
```

---

## ğŸš€ Usage Examples

### Get Customers
```bash
curl -X GET https://localhost:7148/api/customers?companyId=123 \
  -H "Authorization: Bearer TOKEN"
```

### Create Appointment
```bash
curl -X POST https://localhost:7148/api/appointments \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "customerID": 1,
    "serviceTypeId": "SVC001",
    "apptDateTime": "2024-01-27T10:00:00Z"
  }'
```

### Send Email
```bash
curl -X POST https://localhost:7148/api/email/send \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "companyID": "123",
    "subject": "Test Email",
    "recipientToEmail": "test@example.com"
  }'
```

---

## ğŸ”’ Authorization Policies

| Policy | Access |
|--------|--------|
| `RequireMFA` | MFA required |
| `AdminOnly` | Admins only |
| `UserOrAdmin` | Users or Admins |

---

## ğŸ“ˆ Rate Limits

- **Default**: 100 requests per minute per IP
- **Configuration**: See `appsettings.json`

---

## ğŸŒ CORS

**Development**: All origins allowed  
**Production**: Configured origins only

---

## ğŸ¯ Base URL

**Development**:
- HTTPS: https://localhost:7148
- HTTP: http://localhost:5148

**Production**: Configure per environment

---

## ğŸ“ Need Help?

- **Swagger**: https://localhost:7148/swagger
- **Health**: https://localhost:7148/health
- **Docs**: See all MD files in root

---

**Last Updated**: 2025-01-27  
**Total Endpoints**: 47  
**Status**: Production Ready âœ…

